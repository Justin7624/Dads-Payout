<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Payout Calculator</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f5f5f5;
  padding:20px;
}
.card{
  max-width:760px;
  background:#fff;
  padding:20px;
  border-radius:8px;
  box-shadow:0 2px 8px rgba(0,0,0,.1);
}
h2{
  margin-top:0;
}
label{
  display:block;
  margin-top:12px;
  font-weight:bold;
}
select,input{
  width:100%;
  padding:8px;
  margin-top:6px;
}
.item-row{
  display:flex;
  gap:10px;
  margin-top:8px;
}
.item-row select,
.item-row input{
  flex:1;
}
.add-btn{
  margin-top:14px;
  padding:8px 12px;
  border:none;
  background:#4CAF50;
  color:#fff;
  cursor:pointer;
  border-radius:4px;
}
.result{
  margin-top:18px;
  background:#fafafa;
  padding:14px;
  border-radius:6px;
  line-height:1.6;
  font-size:15px;
}
.sub{
  padding-left:16px;
  color:#555;
}
</style>
</head>

<body>

<div class="card">
  <h2>Payout Calculator</h2>

  <div id="items-container"></div>
  <button class="add-btn" id="addItemBtn">+ Add Peptide</button>

  <label>Shipping</label>
  <select id="shipping">
    <option value="10">5 Day ($10)</option>
    <option value="15">3 Day ($15)</option>
  </select>

  <div class="result" id="output"></div>
</div>

<script>
/* ================= CONFIG ================= */

const DAD_PERCENT = 0.4545;
const PRICE_MULTIPLIER = 4.29;

/* ================= HELPERS ================= */

// round UP to nearest 5 or 10 only if clearly past threshold
function roundSmart(n){
  const step = n <= 100 ? 5 : 10;
  const lower = Math.floor(n / step) * step;
  if (n - lower <= 1.5) return lower;
  return Math.ceil(n / step) * step;
}

// eliminate floating point noise
function fixFloat(n){
  return Math.round(n * 100) / 100;
}

/* ================= PRODUCT DATA ================= */

const PRODUCTS = {
  "Retatrutide": {5:{raw:14},10:{raw:18},15:{raw:22},20:{raw:25},30:{raw:35}},
  "Tirzepatide": {5:{raw:12},10:{raw:14},15:{raw:17},20:{raw:20},30:{raw:25},40:{raw:30},50:{raw:35},60:{raw:40}},
  "Semaglutide": {5:{raw:13},10:{raw:16},15:{raw:19},20:{raw:22}},
  "Cagrilintide": {5:{raw:20},10:{raw:30}},
  "MOTS-C": {10:{raw:20},30:{raw:40},40:{raw:50}},
  "BPC-157": {10:{raw:16},20:{raw:30}},
  "BPC 5mg + TB 5mg": {10:{raw:22}},
  "BPC 10mg + TB 10mg": {20:{raw:32}},
  "TB500": {5:{raw:18},10:{raw:24}},
  "Melanotan": {10:{raw:15}},
  "Melanotan 2": {10:{raw:15}},
  "GLOW": {70:{raw:30}},
  "KLOW": {80:{raw:35}},
  "NAD+": {500:{raw:18},1000:{raw:34}},
  "Ipamorelin": {5:{raw:14},10:{raw:18}},
  "Tesamorelin": {5:{raw:20},10:{raw:28}},
  "Sermorelin Acetate": {5:{raw:16},10:{raw:22}},
  "SS-31": {10:{raw:20}},
  "IGF-1 LR3": {1:{raw:28}},
  "GHK-CU": {50:{raw:13},100:{raw:18}},
  "DSIP": {5:{raw:15},10:{raw:18},15:{raw:21}},
  "Epithalon": {10:{raw:15},50:{raw:36}},
  "KPV": {10:{raw:15}},
  "Semax": {5:{raw:13},10:{raw:17},30:{raw:30}},
  "Selank": {5:{raw:13},10:{raw:17},30:{raw:30}},
  "5-amino-1mq": {5:{raw:14},10:{raw:17},50:{raw:26}},
  "CJC-1295 (no DAC)": {5:{raw:18},10:{raw:23}},
  "CJC-1295 (no DAC) + Ipamorelin": {10:{raw:20}},
  "AOD-9604": {5:{raw:19},10:{raw:27}},
  "FOXO4-DRI": {10:{raw:50}},
  "AHK-CU": {100:{raw:17}},
  "Glutathione": {1500:{raw:20}},
  "HGH 191AA": {10:{raw:16},15:{raw:20},24:{raw:24},36:{raw:28}},
  "KissPeptin-10": {10:{raw:18}},
  "Bacteriostatic Water": {10:{raw:6}},
  "Hospira Bacteriostatic Water": {30:{raw:19.50}},
  "Acetic Acid": {10:{raw:12}}
};

/* ===== AUTO-CALCULATE SALE PRICES ===== */

for(const p in PRODUCTS){
  for(const mg in PRODUCTS[p]){
    const raw = PRODUCTS[p][mg].raw;
    PRODUCTS[p][mg].sale = roundSmart(raw * PRICE_MULTIPLIER);
  }
}

/* ================= UI ================= */

const itemsContainer = document.getElementById("items-container");
const shippingSelect = document.getElementById("shipping");

function createItemRow(){
  const row = document.createElement("div");
  row.className = "item-row";

  const prodSelect = document.createElement("select");
  Object.keys(PRODUCTS).forEach(p=>{
    const opt = document.createElement("option");
    opt.value = p;
    opt.textContent = p;
    prodSelect.appendChild(opt);
  });

  const mgSelect = document.createElement("select");

  function loadMGs(){
    mgSelect.innerHTML = "";
    Object.keys(PRODUCTS[prodSelect.value]).forEach(mg=>{
      const opt = document.createElement("option");
      opt.value = mg;
      opt.textContent = mg + " mg";
      mgSelect.appendChild(opt);
    });
  }

  loadMGs();
  prodSelect.addEventListener("change", loadMGs);

  const qty = document.createElement("input");
  qty.type = "number";
  qty.min = 1;
  qty.value = 1;

  row.appendChild(prodSelect);
  row.appendChild(mgSelect);
  row.appendChild(qty);
  itemsContainer.appendChild(row);

  [prodSelect, mgSelect, qty].forEach(el=>el.addEventListener("change", calculate));
}

document.getElementById("addItemBtn").addEventListener("click", createItemRow);
createItemRow();

/* ================= CALCULATION ================= */

function calculate(){
  const shipping = Number(shippingSelect.value);

  let productSubtotal = 0;
  let dadProductRaw = 0;
  let dadCost = 0;

  document.querySelectorAll(".item-row").forEach(row=>{
    const prod = row.children[0].value;
    const mg = row.children[1].value;
    const qty = Number(row.children[2].value);

    const sale = PRODUCTS[prod][mg].sale;
    const raw = PRODUCTS[prod][mg].raw;

    productSubtotal += sale * qty;
    dadProductRaw += sale * qty * DAD_PERCENT;
    dadCost += raw * qty;
  });

  const dadProduct = roundSmart(dadProductRaw);
  const dadPayout = dadProduct + shipping;
  const orderTotal = productSubtotal + shipping;

  const dadTakeHome = dadPayout - dadCost;
  const yourNet = orderTotal - dadPayout;

  document.getElementById("output").innerHTML = `
<strong>Order Total:</strong> $${orderTotal}<br>
<strong>Dad Payout:</strong> $${dadPayout}<br>
<div class="sub">└─ Products: $${dadProduct}</div>
<div class="sub">└─ Shipping: $${shipping}</div>
<strong>Dad Cost:</strong> $${dadCost}<br>
<strong>Dad Take-Home:</strong> $${dadTakeHome}<br>
<strong>Your Net:</strong> $${yourNet}
`;
}

shippingSelect.addEventListener("change", calculate);
calculate();
</script>

</body>
</html>
