<script>
const DAD_PERCENT = 0.4545;

/* ---------- Helper: Round UP to nearest 5 or 10 ---------- */
function roundSmart(n){
  const step = n <= 100 ? 5 : 10;

  const lower = Math.floor(n / step) * step;
  const upper = Math.ceil(n / step) * step;

  // If price is within $1.5 of the LOWER step, round DOWN
  if (n - lower <= 1.5) {
    return lower;
  }

  return upper;
}

const PRICE_MULTIPLIER = 4.29;

/*
  ðŸ”§ DATA ONLY â€” paste your values here locally
  Rename Product A/B/C/etc as needed.
  Raw prices are still required; sale prices will be calculated automatically
*/
const PRODUCTS = {
  "Retatrutide": {
    5:  { sale: 0, raw: 14 },
    10: { sale: 0, raw: 18 },
    15: { sale: 0, raw: 22 },
    20: { sale: 0, raw: 25 },
    30: { sale: 0, raw: 35 }
  },
  "Product B": {
    5:  { sale: 0, raw: 0 },
    10: { sale: 0, raw: 0 },
    15: { sale: 0, raw: 0 },
    20: { sale: 0, raw: 0 },
    30: { sale: 0, raw: 0 }
  },
  "Product C": {
    5:  { sale: 0, raw: 0 },
    10: { sale: 0, raw: 0 },
    15: { sale: 0, raw: 0 },
    20: { sale: 0, raw: 0 },
    30: { sale: 0, raw: 0 }
  }
};

/* ---------- AUTO-CALCULATE SALE PRICES ---------- */
for (const productName in PRODUCTS) {
  const product = PRODUCTS[productName];
  for (const mg in product) {
    const rawPrice = product[mg].raw;
    const salePrice = roundSmart(rawPrice * PRICE_MULTIPLIER);
    product[mg].sale = salePrice;
  }
}

/* ---------- UI SETUP ---------- */
const productSelect = document.getElementById("product");
const mgSelect = document.getElementById("mg");

Object.keys(PRODUCTS).forEach(p => {
  const opt = document.createElement("option");
  opt.value = p;
  opt.textContent = p;
  productSelect.appendChild(opt);
});

function loadMGs() {
  mgSelect.innerHTML = "";
  const product = PRODUCTS[productSelect.value];
  Object.keys(product).forEach(mg => {
    const opt = document.createElement("option");
    opt.value = mg;
    opt.textContent = `${mg} mg`;
    mgSelect.appendChild(opt);
  });
}

function calculate() {
  const product = PRODUCTS[productSelect.value];
  const mg = mgSelect.value;
  const qty = Number(document.getElementById("qty").value);

  const sale = product[mg].sale;
  const raw = product[mg].raw;

  const total = sale * qty;
  const dadPayout = total * DAD_PERCENT;
  const dadCost = raw * qty;
  const dadTakeHome = dadPayout - dadCost;
  const yourNet = total - dadPayout;

  document.getElementById("output").innerHTML = `
    <strong>Order Total:</strong> $${total.toFixed(2)}<br>
    <strong>Dad Payout:</strong> $${dadPayout.toFixed(2)}<br>
    <strong>Dad Cost:</strong> $${dadCost.toFixed(2)}<br>
    <strong>Dad Take-Home:</strong> $${dadTakeHome.toFixed(2)}<br>
    <strong>Your Net:</strong> $${yourNet.toFixed(2)}
  `;
}

productSelect.addEventListener("change", () => {
  loadMGs();
  calculate();
});
mgSelect.addEventListener("change", calculate);
document.getElementById("qty").addEventListener("input", calculate);

loadMGs();
calculate();
</script>
