<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Payout Calculator</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f5f5;
  padding: 20px;
}
.card {
  max-width: 620px;
  background: #fff;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,.1);
}
label {
  display: block;
  margin-top: 12px;
  font-weight: bold;
}
select, input {
  width: 100%;
  padding: 8px;
  margin-top: 6px;
}
.result {
  margin-top: 18px;
  background: #fafafa;
  padding: 12px;
  border-radius: 6px;
}
</style>
</head>
<body>

<div class="card">
  <h2>Payout Calculator</h2>

  <label>Product</label>
  <select id="product"></select>

  <label>MG Strength</label>
  <select id="mg"></select>

  <label>Quantity</label>
  <input type="number" id="qty" value="1" min="1">

  <label>Shipping</label>
  <select id="shipping">
    <option value="10">5-Day ($10)</option>
    <option value="15">3-Day ($15)</option>
  </select>

  <div class="result" id="output"></div>
</div>

<script>
const DAD_PERCENT = 0.4545;

/* ---------- Helper: Round UP or DOWN (for sale prices) ---------- */
function roundSmart(n){
  const step = n <= 100 ? 5 : 10;
  const lower = Math.floor(n / step) * step;
  const upper = Math.ceil(n / step) * step;
  if (n - lower <= 1.5) return lower; // can round down for sale
  return upper;
}

/* ---------- Helper: Round using same logic but never below n ---------- */
function roundDad(n){
  const step = n <= 100 ? 5 : 10;
  const lower = Math.floor(n / step) * step;
  const upper = Math.ceil(n / step) * step;
  if (n - lower <= 1.5) return n; // never round down
  return upper; // otherwise round up
}

const PRICE_MULTIPLIER = 4.29;

/* ---------- PRODUCT DATA (with RAW values) ---------- */
const PRODUCTS = {
  "Retatrutide": {5:{raw:14},10:{raw:18},15:{raw:22},20:{raw:25},30:{raw:35}},
  "Tirzepatide": {5:{raw:15},10:{raw:18},15:{raw:22},20:{raw:26},30:{raw:30},40:{raw:35},50:{raw:40},60:{raw:45}},
  "Semaglutide": {5:{raw:12},10:{raw:16},15:{raw:20},20:{raw:24}},
  "Cagrilintide": {5:{raw:10},10:{raw:18}},
  "MOTS-C": {10:{raw:12},30:{raw:28},40:{raw:35}},
  "BPC-157": {10:{raw:10},20:{raw:18}},
  "BPC 5mg + TB 5mg": {10:{raw:15}},
  "BPC 10mg + TB 10mg": {20:{raw:28}},
  "TB500": {5:{raw:12},10:{raw:22}},
  "Melanotan": {10:{raw:15}},
  "Melanotan 2": {10:{raw:18}},
  "GLOW": {70:{raw:60}},
  "KLOW": {80:{raw:65}},
  "NAD+": {500:{raw:50},1000:{raw:95}},
  "Ipamorelin": {5:{raw:12},10:{raw:20}},
  "Tesamorelin": {5:{raw:15},10:{raw:28}},
  "Sermorelin Acetate": {5:{raw:12},10:{raw:22}},
  "SS-31 2": {10:{raw:18}},
  "IGF-1 LR3": {1:{raw:10}},
  "GHK-CU": {50:{raw:18},100:{raw:35}},
  "DSIP": {5:{raw:12},10:{raw:20},15:{raw:28}},
  "Epithalon": {10:{raw:15},50:{raw:60}},
  "KPV": {"see label":{raw:0}},
  "Semax": {5:{raw:12},10:{raw:20},30:{raw:50}},
  "Selank": {5:{raw:12},10:{raw:20},30:{raw:50}},
  "5-amino-1mq": {5:{raw:12},10:{raw:20},50:{raw:95}},
  "CJC-1295 (no DAC)": {5:{raw:12},10:{raw:20}},
  "CJC-1295 + Ipamorelin": {10:{raw:22}},
  "AOD-9604": {5:{raw:12},10:{raw:20}},
  "FOXO4-DRI": {10:{raw:35}},
  "AHK-CU": {100:{raw:75}},
  "Glutathione": {1500:{raw:50}},
  "HGH 191AA": {10:{raw:35},15:{raw:50},24:{raw:80},36:{raw:120}},
  "KissPeptin-10": {10:{raw:18}},
  "Bacteriostatic Water": {10:{raw:3}},
  "Hospira Bacteriostatic Water": {30:{raw:6}},
  "Acetic Acid": {10:{raw:3}}
};

/* ---------- AUTO-CALCULATE SALE PRICES ---------- */
for (const productName in PRODUCTS) {
  const product = PRODUCTS[productName];
  for (const mg in product) {
    const rawPrice = product[mg].raw;
    const salePrice = roundSmart(rawPrice * PRICE_MULTIPLIER);
    product[mg].sale = salePrice;
  }
}

/* ---------- UI SETUP ---------- */
const productSelect = document.getElementById("product");
const mgSelect = document.getElementById("mg");
const shippingSelect = document.getElementById("shipping");

Object.keys(PRODUCTS).forEach(p => {
  const opt = document.createElement("option");
  opt.value = p;
  opt.textContent = p;
  productSelect.appendChild(opt);
});

function loadMGs() {
  mgSelect.innerHTML = "";
  const product = PRODUCTS[productSelect.value];
  Object.keys(product).forEach(mg => {
    const opt = document.createElement("option");
    opt.value = mg;
    opt.textContent = `${mg} mg`;
    mgSelect.appendChild(opt);
  });
}

function calculate() {
  const product = PRODUCTS[productSelect.value];
  const mg = mgSelect.value;
  const qty = Number(document.getElementById("qty").value);
  const shipping = Number(shippingSelect.value);

  const sale = product[mg].sale;
  const raw = product[mg].raw;

  const subtotal = sale * qty;
  const total = subtotal; // your net calculation ignores shipping

  // Dad payout includes subtotal + shipping
  const dadPayoutRaw = (subtotal + shipping) * DAD_PERCENT;
  const dadPayout = roundDad(dadPayoutRaw);

  const dadCost = raw * qty;
  const dadTakeHome = dadPayout - dadCost;
  const yourNet = subtotal - (dadPayout - shipping); // subtract only dad's portion of sales

  document.getElementById("output").innerHTML = `
    <strong>Order Total:</strong> $${(subtotal + shipping).toFixed(2)}<br>
    <strong>Dad Payout:</strong> $${dadPayout.toFixed(2)}<br>
    <strong>Dad Cost:</strong> $${dadCost.toFixed(2)}<br>
    <strong>Dad Take-Home:</strong> $${dadTakeHome.toFixed(2)}<br>
    <strong>Your Net:</strong> $${yourNet.toFixed(2)}
  `;
}

productSelect.addEventListener("change", () => {
  loadMGs();
  calculate();
});
mgSelect.addEventListener("change", calculate);
document.getElementById("qty").addEventListener("input", calculate);
shippingSelect.addEventListener("change", calculate);

loadMGs();
calculate();
</script>

</body>
</html>
